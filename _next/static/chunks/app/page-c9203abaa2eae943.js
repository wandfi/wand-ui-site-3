(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{30786:function(e,t,s){Promise.resolve().then(s.bind(s,39318))},39318:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var a=s(31113),l=s(22139),n=s(68535),i=s(64370),r=s(77503),o=s(6069),d=s(17370),c=s(22298),m=s(53060);let x=(0,r.v)({transport:(0,o.d)("https://rpc.ankr.com/story_mainnet")}),u=(0,d.V)(["function assetBalance() public view returns (uint256)"]);async function getAssetAmoutBy(e,t){try{return await x.readContract({abi:u,address:e,functionName:"assetBalance"})}catch(s){return x.readContract({abi:c.Wo,address:t,functionName:"balanceOf",args:[e]})}}var f=s(19757),h=s(59175),g=s(64103),p=s(9068),b=s(15506),v=s(26504),y=s(26361),w=s(84944),k=s(41690),N=s.n(k),j=s(60900);function Home(){let{tvl:e}=function(){let e=(0,h.p)(),t=f.iK[e],s=f.VQ[e]||[],{earns:a,prices:n,totalSupplies:i,vaultUSBTotal:r,plainVaultsStat:o}=(0,g.useContext)(p.g),d=t.map(e=>r[e.vault]).reduce((e,t)=>e+t,0n),c=[{name:"USB",symbol:"USB",address:f.O1[e]}].concat(t.map(e=>({name:e.xTokenSymbol+e.version,symbol:e.xTokenSymbol,address:e.xTokenAddress}))).map(e=>{let t=n[e.address],s="USB"==e.symbol?d:i[e.address],a=t*s/l.Pq;return{...e,price:t,amount:s,usdAmount:a}}).concat(t.filter(e=>!e.isStable).map(e=>{console.info("earns:",a[e.ptyPoolAboveAddress]);let t=a[e.ptyPoolAboveAddress].totalStake+a[e.ptyPoolBelowAddress].balance,s=n[e.assetTokenAddress],i=s*t/l.Pq;return{name:e.assetTokenSymbol+e.version,symbol:e.assetTokenSymbol,address:e.assetTokenAddress,price:s,amount:t,usdAmount:i}})).concat(s.map(e=>{let t=n[e.assetToken],s=o[e.vault].totalSupply,a=t*s/l.Pq;return{name:e.assetTokenSymbol,symbol:e.assetTokenSymbol,address:e.assetToken,price:t,amount:s,usdAmount:a}})),m=c.reduce((e,t)=>e+t.usdAmount,0n);return{tvl:m,tvlItems:c}}(),t=function(){var e,t;let s=(0,h.p)(),a=null===(e=f.Lh[s])||void 0===e?void 0:e[0],n=null===(t=f.Lh[s])||void 0===t?void 0:t[1],{prices:i}=(0,g.useContext)(p.g),{data:r}=(0,b.uX)({contracts:[{abi:v.Wn,address:f.O6[s],functionName:"getVaultState",args:[null==a?void 0:a.vault]},{abi:v.Wn,address:f.O6[s],functionName:"getStableVaultState",args:[null==n?void 0:n.vault]},{abi:v.aT,address:null==a?void 0:a.ptyPoolAboveAddress,functionName:"totalStakingBalance"}]}),o=(0,y.ok)(r,[0,"result","M_ETH"]),d=(0,y.ok)(r,[1,"result","M_USDC"]),c=(0,y.ok)(r,[2,"result"]);return(o+c)*i[f.K8]/l.Pq+d*i[null==n?void 0:n.assetTokenAddress]/l.Pq}(),{data:s}=(0,i.a)({queryKey:["storyTVL"],gcTime:36e5,initialData:0n,queryFn:async()=>{let[e,t,s,a,i]=await Promise.all([(0,n.XF)(),getAssetAmoutBy("0x72b3f85D0f1d05af9ea733DB3AD15d0ba9cB47b5","0x5267F7eE069CEB3D8F1c760c215569b79d0685aD"),getAssetAmoutBy("0x29038303100931fA3Cd421ceb1632F1Bb22950Ac","0x5267F7eE069CEB3D8F1c760c215569b79d0685aD"),getAssetAmoutBy("0x868454427252E0Dc69ebCdB07dE07818B9599a7a","0xd5255Cc08EBAf6D54ac9448822a18d8A3da29A42"),getAssetAmoutBy("0x841A04a5b30ee9270E1E51658545E280e4682668","0xb5461c1FD0312Cd4bF037058F8a391e6A42F9639")]),r=e[0].price,o=e[1].price,d=r*(t+s)/l.Pq+a*BigInt(1e12)+o*i/l.Pq;return console.info("story tvl:",(0,m.d)(d),(0,m.d)(o),(0,m.d)(i)),d}});return(0,a.jsxs)("div",{className:"flex max-w-screen-xl mx-auto px-4 flex-col h-[calc(100vh-100px)] items-center pb-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6 gap-2",children:[(0,a.jsx)(j.RSW,{className:"text-[#ff0000] text-lg"})," ",(0,a.jsx)("a",{href:l.QG,className:"underline underline-offset-[3px]",children:"Wand is now live on Monad Mainnet"})]}),(0,a.jsxs)("h1",{className:"flex md:px-8 text-[min(6vw,1.875rem)] font-extrabold text-slate-700 dark:text-slate-50 text-center",children:[(0,a.jsx)("svg",{className:"mr-2 animate-bounce self-end shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M8 0C9.37146 3.70633 12.2937 6.62854 16 8C12.2937 9.37146 9.37146 12.2937 8 16C6.62854 12.2937 3.70633 9.37146 0 8C3.70633 6.62854 6.62854 3.70633 8 0Z",fill:"#10B981"})}),"A Structured Protocol for",(0,a.jsx)("br",{})," Better Asset Utilization",(0,a.jsx)("svg",{className:"ml-2 animate-bounce shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M8 0C9.37146 3.70633 12.2937 6.62854 16 8C12.2937 9.37146 9.37146 12.2937 8 16C6.62854 12.2937 3.70633 9.37146 0 8C3.70633 6.62854 6.62854 3.70633 8 0Z",fill:"#6366F1"})})]}),(0,a.jsxs)("div",{className:"relative flex-1 w-full md:bg-white mt-6 flex flex-col sm:flex-row gap-2 md:p-2 text-2xl rounded-2xl text-white",children:[(0,a.jsx)("img",{src:"./balance.png",style:{aspectRatio:"524/600"},className:"object-fill w-full h-auto max-w-[270px] md:max-w-[350px] absolute z-10 top-[44%] md:top-1/2 right-0 left-1/2 -translate-x-1/2 -translate-y-1/2"}),(0,a.jsxs)("div",{className:"min-h-[240px] md:min-h-[400px] relative bg-emerald-500 overflow-hidden flex-1 p-4 md:pt-10 md:px-7 rounded-xl",children:[(0,a.jsx)("div",{className:"p-2 bg-white rounded-2xl w-fit",children:(0,a.jsx)(N(),{alt:"riskoff",width:48,height:48,src:"/riskoff.svg"})}),(0,a.jsx)("h3",{className:"font-bold text-2xl mt-3 lg:text-2xl",children:"Risk Off"}),(0,a.jsxs)("div",{className:"text-sm lg:text-lg relative z-20 mt-4 !leading-tight",children:["Stable Coin",(0,a.jsx)("br",{}),"Principal Token"]})]}),(0,a.jsxs)("div",{className:"min-h-[480px] relative overflow-hidden bg-indigo-500 text-right justify-end items-end flex flex-col flex-1 p-4 md:pb-10 md:px-7 rounded-xl",children:[(0,a.jsx)("div",{className:"p-2 bg-white rounded-2xl w-fit flex gap-1 z-50",children:(0,a.jsx)(N(),{alt:"USB",width:48,height:48,src:"/riskon.svg"})}),(0,a.jsx)("span",{className:"font-bold text-lg mt-3 lg:text-2xl relative z-10",children:"Risk On"}),(0,a.jsxs)("div",{className:"text-sm lg:text-lg mt-4 !leading-tight",children:["Margin Token",(0,a.jsx)("br",{}),"Yield Token"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-12 absolute -right-16 -top-48 rounded-full items-center justify-center",style:{transform:"rotateX(60deg) rotateY(0deg) rotateZ(-45deg)"},children:[(0,a.jsx)(N(),{width:384,height:384,src:"/ETH.svg",alt:"ETH",className:"relative left-1/4 grayscale mix-blend-luminosity opacity-20 col-span-2"}),(0,a.jsx)(N(),{width:384,height:384,src:"/WBTC.svg",alt:"WBTC",className:"mix-blend-luminosity opacity-20 grayscale"}),(0,a.jsx)(N(),{width:384,height:384,src:"/stETH.svg",alt:"WBTC",className:"mix-blend-luminosity opacity-20 grayscale"})]})]})]}),(0,a.jsxs)("div",{className:"w-full px-4 pb-8 md:pt-8 text-3xl font-extrabold text-slate-700 dark:text-slate-50",children:[(0,a.jsx)("span",{className:"text-lg whitespace-nowrap",children:"Total Value Locked:"})," $",(0,w.dq)(e+t+s)]})]})}},84944:function(e,t,s){"use strict";s.d(t,{Rp:function(){return displayBalanceWithUnit},dq:function(){return displayBalance}});var a=s(7530),l=s(53060);let displayBalanceWithUnit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2?arguments[2]:void 0;if(!e)return"0";let l=10**t,n=Math.floor(Number((0,a.b)(e,s))*l)/l,i=Number((.1**t).toFixed(t));return n>0&&n<i?"<"+i:n<0&&n>-i?"≈0":n.toLocaleString("en-US",{maximumFractionDigits:t})},displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return"0";let a=Number((0,l.d)(e)),n=Number((.1**t).toFixed(t));return a>0&&a<n?"<"+n:a<0&&a>-n?"≈0":a.toLocaleString("en-US",{...s||{},maximumFractionDigits:t})}}},function(e){e.O(0,[7495,9633,8869,3848,2970,1578,6287,7093,604,1744],function(){return e(e.s=30786)}),_N_E=e.O()}]);
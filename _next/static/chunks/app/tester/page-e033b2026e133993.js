(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6161],{81357:function(e,t,n){Promise.resolve().then(n.bind(n,71080))},71080:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return TesterPage}});var a=n(31113),r=n(58875),s=n(26504),i=n(19757),o=n(59175),c=n(15506),l=n(84944),u=n(33501),d=n(64103),p=n(83419),f=n(58409),m=n(12396);function TesterPage(){let e=(0,o.p)(),t=i.iK[e],[{value:n,feed:h},v]=(0,f.Z)({value:"",feed:t[0].assetTokenFeed}),x=(0,d.useMemo)(()=>t.map(e=>({label:e.assetTokenSymbol+e.version,value:e.assetTokenFeed})),[]),{data:g}=(0,c.D2)({abi:s.nq,address:h,functionName:"latestPrice"}),b=g||0n;return(0,a.jsx)("div",{className:"w-full flex",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1 w-full max-w-[840px] mx-auto px-5",children:[(0,a.jsx)(p.ZP,{defaultValue:x[0],options:x,onChange:e=>v({feed:null==e?void 0:e.value})}),(0,a.jsx)("input",{value:n.toString(),onChange:e=>{let t=(e.target.value||"").replaceAll("-","").replaceAll("+","");v({value:t})},type:"number",className:(0,u.Z)("bg-white border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-2xl border focus:border-2 text-slate-700 rounded-md outline-none"),pattern:"[0-9.]{36}",step:1,placeholder:"0"}),(0,a.jsxs)("div",{children:["Price: ",(0,l.Rp)(b,2,8)]}),(0,a.jsx)(r.v,{tx:"Update",config:{abi:s.Og,address:h,functionName:"mockPrice",args:[(0,m.v)(n,8)]},onTxSuccess:()=>{v({value:""})},className:"btn-primary flex items-center justify-center gap-4"})]})})}},58875:function(e,t,n){"use strict";n.d(t,{v:function(){return ApproveAndTx}});var a=n(31113),r=n(19757),s=n(26361),i=n(64103),o=n(47259),c=n(22298),l=n(72366),u=n(28294),d=n(64040);let p={},useApproves=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:a,chainId:f}=(0,l.m)(),m=(0,u.t)(),{data:h}=(0,d.p)(),[v,x]=(0,i.useState)(!1),g=(0,i.useMemo)(()=>Object.keys(e).filter(e=>e!==r.K8),[e]),[b,w]=(0,i.useState)(t&&p[t]||{}),updateAllownce=(e,n)=>{t&&(p[t]={...p[t]||{},[e]:n},w(t=>({...t,[e]:n})))},y=(0,u.t)();(0,i.useEffect)(()=>{a&&t&&m&&f&&g.forEach(e=>{m.readContract({abi:c.Wo,address:e,functionName:"allowance",args:[a,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[g,f,a]);let[N,A]=(0,i.useState)(!1),j=(0,i.useMemo)(()=>g.filter(t=>(0,s.ok)(e,t)>0n&&(0,s.ok)(e,t)>(0,s.ok)(b,t)),[e,g,b]),approve=async()=>{if(0!=j.length&&t)try{A(!0),x(!1);for(let a=0;a<j.length;a++){let r=j[a],s=!1===n?e[r]:n,i=await (null==h?void 0:h.writeContract({abi:c.Wo,address:r,functionName:"approve",args:[t,s]}));i&&await (null==y?void 0:y.waitForTransactionReceipt({hash:i})),updateAllownce(r,s)}o.A.success("Approve success"),A(!1),x(!0)}catch(e){throw o.A.error((0,s.az)(e)),A(!1),x(!1),e}};return{approve,loading:N,shouldApprove:j.length>0,isSuccess:v}};var f=n(15506),m=n(82701),h=n(33501);let Spinner=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{fill:"none",className:(0,h.Z)(t,"animate-spin h-5 w-5 2-ml-1 2mr-3"),viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})};function ApproveAndTx(e){let{className:t,tx:n,approves:r,spender:c,requestAmount:l,config:p,toast:h=!0,disabled:v,onTxSuccess:x,onApproveSuccess:g}=e,{write:b,isDisabled:w,isLoading:y}=function(e,t){let{autoToast:n=!0,onSuccess:a}=t||{},[r,c]=(0,i.useState)(!1),[l,p]=(0,i.useState)(!1),m=(0,u.t)(),{data:h}=(0,d.p)(),v=!m||!h||!h.account||r||!e,x=(0,f.hp)(),write=async()=>{if(!v){c(!0),p(!1);try{let t="function"==typeof e?await e():e,{request:r}=await m.simulateContract({account:h.account,...t}),s=await h.writeContract(r),i=await m.waitForTransactionReceipt({hash:s});if("success"!==i.status)throw"Transaction reverted";p(!0),a&&a(),n&&o.A.success("Transaction success"),x.update()}catch(e){n&&o.A.error((0,s.az)(e))}c(!1)}};return{write,isDisabled:v,isLoading:r,isSuccess:l}}(p,{onSuccess:()=>x&&x(),autoToast:h}),N=v||w||y||!1===p.enabled,{approve:A,shouldApprove:j,loading:S,isSuccess:k}=useApproves(r||{},c,l),C=(0,i.useRef)();return(C.current=g,(0,i.useEffect)(()=>{C.current&&k&&C.current()},[k]),j)?(0,a.jsxs)("button",{className:(0,m.m)("btn-primary flex items-center justify-center gap-4",t),onClick:A,disabled:v||!A||S,children:[S&&(0,a.jsx)(Spinner,{}),"Approve"]}):(0,a.jsxs)("button",{className:(0,m.m)("btn-primary flex items-center justify-center gap-4",t),onClick:()=>b(),disabled:N,children:[y&&(0,a.jsx)(Spinner,{}),n]})}},84944:function(e,t,n){"use strict";n.d(t,{Rp:function(){return displayBalanceWithUnit},dq:function(){return displayBalance}});var a=n(7530),r=n(53060);let displayBalanceWithUnit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2?arguments[2]:void 0;if(!e)return"0";let r=10**t,s=Math.floor(Number((0,a.b)(e,n))*r)/r,i=Number((.1**t).toFixed(t));return s>0&&s<i?"<"+i:s<0&&s>-i?"≈0":s.toLocaleString("en-US",{maximumFractionDigits:t})},displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return"0";let a=Number((0,r.d)(e)),s=Number((.1**t).toFixed(t));return a>0&&a<s?"<"+s:a<0&&a>-s?"≈0":a.toLocaleString("en-US",{...n||{},maximumFractionDigits:t})}}},function(e){e.O(0,[7495,8869,1346,1981,1578,7093,604,1744],function(){return e(e.s=81357)}),_N_E=e.O()}]);